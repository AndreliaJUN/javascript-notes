# 执行环境及作用域
> - 全局执行环境
>    - 最外围的执行环境
>    - 在web浏览器中被认为是window对象
>    - 某个执行环境的所有代码执行完毕后，该环境被销毁，保存在其中的所有变量和函数也被销毁。
>    - 但是全局执行环境知道应用程序退出例如关闭网页或浏览器才被销毁。
>    - 全局环境只能访问在全局环境中定义的变量和函数，不能直接访问局部环境中的任何数据。
> - 函数执行环境。
>    - 函数的局部环境不仅有权访问函数作用域中的变量，而且有权访问其包含（父）环境，乃至全局环境。
>    - 当执行流进入一个函数时，函数的环境就会被推入一个环境栈中。在函数执行后，栈将其环境弹出，把控制权返回给之前的执行环境。
---
> - 作用域链
>    - 用途是保证对执行环境有权访问的所有变量和函数的有序访问。
>    - 作用域链的前端，始终都是当前执行的代码所在环境的变量对象。
>    - 全局执行环境的变量对象始终是作用域链的最后一个对象。
---
## 4.2.1延长作用域链
> 有些语句可以再作用域链前端临时增加一个变量对象，代码执行后变量对象移除
###### 两种情况会增加作用域链：
- try-cache语句的catch块
- with语句
---
## 4.2.2没有块级作用域
> 在其他语言如c语言中，花括号内封闭代码有自己的作用域（在ECMAScript中叫执行环境），但是在js中没有。

###### 在js中一定记住的特殊情况：
- 在JavaScript中，if语句中变量声明会将变量添加到当前的执行环境（在这里是全局环境）中。
```javascript
if(true){
  var color="blue";
}
alert(color);//"blue"
//如果是在c语言等其他语言里，color会在if执行完之后被销毁，但是在js中不会
```
- 在JavaScript中，for语句创建的i变量及时在for循环执行结束后，依然会存在于循环外部的执行环境中。
```js
for(var i=0;i<10;i++>)
{
  doSomething(i);
}
alert(i);//10
```

### 1.声明变量
- 使用var声明的变量会自动被添加到最接近的环境中
   - 在函数内部，最接近的环境就是函数的局部环境；
   - 在with语句中，最接近的环境是函数环境；
   - 如果初始化变量时没有使用var声明，该变量将自动被添加到全局环境。
   - >（不推荐这种做法，建议在初始化变量之前，一定先声明，否则在严格模式下会报错）

### 2.查询标识符
- 就是找变量，从内往外找，先局部后全局，沿着作用域链向上搜索。
- 如果局部环境中存在着同名标识符，就不会使用位于父环境的标识符（就近）。
---